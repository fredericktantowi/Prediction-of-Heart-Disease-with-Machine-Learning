---
title: "Supervised Machine Learning: Presence of Heart Disease"
author: "Frederick Michael Tantowi"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(dplyr)
library(tidyverse)
library(ggplot2)
library(caret)
library(class)
library(corrplot)
library(Hmisc)
library(fastDummies)
```


## R Markdown

Loading the data
```{r}
heart <- read_csv("heart.csv")
summary(heart)
head(heart)
```
```{r}
#Change variable to data type "factor"
heart$HeartDisease <- as.factor(heart$HeartDisease)
heart$FastingBS <- as.factor(heart$FastingBS)

#dummifying variables
heart <- dummy_cols(heart, select_columns = c('Sex', 'ChestPainType', 'RestingECG', 'ExerciseAngina', 'ST_Slope'))
heart <- subset(heart, select = -c(Sex, ChestPainType, RestingECG, ExerciseAngina, ST_Slope) )
head(heart)
```

```{r}
rcorr(as.matrix(heart))
```
```{r}
corrplot(cor(heart[,c("Age", "RestingBP", "Cholesterol", "MaxHR", "Oldpeak")]),method='number', number.digits = 1, number.cex = 1.5, tl.cex = 1.5)
```
Logistic Regression
```{r}
glmModel <- glm(data = heart, formula = HeartDisease ~ ., family = "binomial")
summary(glmModel)
```
Cross Validation
```{r}
step(glmModel)
```

















